<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Code Humanizer</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<h1>Code Humanizer - Umanoide</h1>
<textarea id="codeInput" placeholder="Inserisci codice qui..." rows="15"></textarea>

<div>
    <label for="langSelect">Linguaggio:</label>
    <select id="langSelect">
        {% for lang in languages %}
        <option value="{{ lang }}">{{ lang }}</option>
        {% endfor %}
    </select>
</div>

<div>
    <button onclick="processCode('spiegazione')">Spiegazione</button>
    <button onclick="processCode('traduzione')">Traduzione</button>
    <button onclick="processCode('fix')">Fix</button>
</div>

<div id="result"></div>

<script>
async function processCode(task){
    const code = document.getElementById('codeInput').value;
    const lang = document.getElementById('langSelect').value;
    const target_lang = task === 'traduzione' ? lang : null;
    const resp = await fetch('/api/code', {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify({code, task, target_lang, lang})
    });
    const data = await resp.json();
    document.getElementById('result').innerHTML = data.result;
}
</script>
</body>
</html>
